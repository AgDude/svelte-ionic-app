import{n as t,s as e,r as n,i as s,g as r,S as a,a as o,c,e as u,m as l,b as i,d as p,f,h as d,t as h,j as m,k as $,l as g,o as y,p as b,q as x,u as E,v,w,x as k}from"./index-dad9da95.js";const j=[];function A(n,s=t){let r;const a=[];function o(t){if(e(n,t)&&(n=t,r)){const t=!j.length;for(let t=0;t<a.length;t+=1){const e=a[t];e[1](),j.push(e,n)}if(t){for(let t=0;t<j.length;t+=2)j[t][0](j[t+1]);j.length=0}}}return{set:o,update:function(t){o(t(n))},subscribe:function(e,c=t){const u=[e,c];return a.push(u),1===a.length&&(r=s(o)||t),e(n),()=>{const t=a.indexOf(u);-1!==t&&a.splice(t,1),0===a.length&&(r(),r=null)}}}}function K(e,r,a){const o=!Array.isArray(e),c=o?[e]:e,u=r.length<2;return{subscribe:A(a,e=>{let a=!1;const l=[];let i=0,p=t;const f=()=>{if(i)return;p();const n=r(o?l[0]:l,e);u?e(n):p=s(n)?n:t},d=c.map((t,e)=>t.subscribe(t=>{l[e]=t,i&=~(1<<e),a&&f()},()=>{i|=1<<e}));return a=!0,f(),function(){n(d),p()}}).subscribe}}const O={subscribe:t=>K(r("routify"),t=>t.url).subscribe(t)},R={subscribe:t=>K(r("routify"),t=>t.goto).subscribe(t)};function S(t,e){const n=N(t,e);return function(t,s=!0){t=n(t,null,s);const r=n(e.path,null,s),a=new RegExp("^"+t);return r.match(a)}}function B(t,e){const n=N(t,e);return function(t,e,s,a){const o=n(t,e);s?r("routifyupdatepage")(o,a):history.pushState({},null,o)}}function N(t,e){return function(n,s,r){if(n=n||"./",r||(n=n.replace(/index$/,"")),n.match(/^\.\.?\//)){let e=t.path;(n.match(/\.\.\//g)||[]).forEach(()=>{e=e.replace(/\/[^\/]+\/?$/,"")}),n=n.replace(/^[\.\/]+/,""),e=e.replace(/\/$/,"")+"/",n=e+n}else n.match(/^\//);s=Object.assign({},e.params,t.params,s);for(const[t,e]of Object.entries(s))n=n.replace(`:${t}`,e);return n}}const L=A({}),P=RegExp(/\:[^\/\()]+/g),q=function(t){t&&"scroll-lock"!==t.dataset.routify&&(t.scrollTo(0,0),q(t.parentElement))},C=(t,e)=>{const n=e?"":"/?$";return t="^"+(t=(t=t.replace(/\/_fallback?$/,"(/|$)")).replace(/\/index$/,"(/index)?")).replace(P,"([^/]+)")+n},D=t=>{const e=t.match(P);if(e)return e.map(t=>t.substr(1,t.length-2))},F=({path:t,isFallback:e})=>e?t.split("/").map(t=>t.match(/\[|\]/)?"A":"B").join(""):"Z";function M(t){let e,n;const s=[{scoped:t[0]},t[3].param];var r=t[2];function a(t){let e={$$slots:{default:[Z,({scoped:t})=>({6:t}),({scoped:t})=>t?64:0]},$$scope:{ctx:t}};for(let t=0;t<s.length;t+=1)e=k(e,s[t]);return{props:e}}if(r)var o=new r(a(t));return{c(){o&&c(o.$$.fragment),e=u()},m(t,s){o&&l(o,t,s),i(t,e,s),n=!0},p(t,n){const u=9&n?p(s,[1&n&&{scoped:t[0]},8&n&&f(t[3].param)]):{};if(8273&n&&(u.$$scope={dirty:n,ctx:t}),r!==(r=t[2])){if(o){d();const t=o;h(t.$$.fragment,1,0,()=>{m(t,1)}),$()}r?(o=new r(a(t)),c(o.$$.fragment),g(o.$$.fragment,1),l(o,e.parentNode,e)):o=null}else r&&o.$set(u)},i(t){n||(o&&g(o.$$.fragment,t),n=!0)},o(t){o&&h(o.$$.fragment,t),n=!1},d(t){t&&y(e),o&&m(o,t)}}}function T(t){let e;const n=new H({props:{layouts:t[4],scoped:{...t[0],...t[6]}}});return{c(){c(n.$$.fragment)},m(t,s){l(n,t,s),e=!0},p(t,e){const s={};16&e&&(s.layouts=t[4]),65&e&&(s.scoped={...t[0],...t[6]}),n.$set(s)},i(t){e||(g(n.$$.fragment,t),e=!0)},o(t){h(n.$$.fragment,t),e=!1},d(t){m(n,t)}}}function Z(t){let e,n,s=t[4].length&&T(t);return{c(){s&&s.c(),e=u()},m(t,r){s&&s.m(t,r),i(t,e,r),n=!0},p(t,n){t[4].length?s?(s.p(t,n),g(s,1)):(s=T(t),s.c(),g(s,1),s.m(e.parentNode,e)):s&&(d(),h(s,1,1,()=>{s=null}),$())},i(t){n||(g(s),n=!0)},o(t){h(s),n=!1},d(t){s&&s.d(t),t&&y(e)}}}function _(t){let e,n,s;return{c(){e=b("span"),s=x(n=t[5].call(null,e))},m(t,n){i(t,e,n)},d(t){t&&y(e),s()}}}function z(t){let e,n,s,r=t[2]&&M(t),a=!t[1]&&_(t);return{c(){r&&r.c(),e=E(),a&&a.c(),n=u()},m(t,o){r&&r.m(t,o),i(t,e,o),a&&a.m(t,o),i(t,n,o),s=!0},p(t,[s]){t[2]?r?(r.p(t,s),g(r,1)):(r=M(t),r.c(),g(r,1),r.m(e.parentNode,e)):r&&(d(),h(r,1,1,()=>{r=null}),$()),t[1]?a&&(a.d(1),a=null):a||(a=_(t),a.c(),a.m(n.parentNode,n))},i(t){s||(g(r),s=!0)},o(t){h(r),s=!1},d(t){r&&r.d(t),t&&y(e),a&&a.d(t),t&&y(n)}}}function G(t,e,n){let s;v(t,L,t=>n(8,s=t));let r,a,{layouts:o=[]}=e,{scoped:c={}}=e;const u=A({});async function l(t){n(2,a=await t.component()),function(t){u.set({route:s,path:t.path,url:N(t,s),goto:B(t,s),isActive:S(t,s)})}(t)}let i,p;return w("routify",u),t.$set=t=>{"layouts"in t&&n(7,o=t.layouts),"scoped"in t&&n(0,c=t.scoped)},t.$$.update=()=>{128&t.$$.dirty&&n(3,[i,...p]=o,i,(n(4,p),n(7,o))),8&t.$$.dirty&&l(i),18&t.$$.dirty&&(p.length||q(r))},[c,r,a,i,p,function(t){n(1,r=t.parentElement)},void 0,o]}class H extends a{constructor(t){super(),o(this,t,G,z,e,{layouts:7,scoped:0})}}function I(t,e){return["pushState","replaceState"].forEach(t=>{const e=history[t];history[t]=function(n,s,r){const a=Object.assign(new Event(t.toLowerCase(),{state:n,title:s,url:r}));return Object.assign(a,{state:n,title:s,url:r}),e.apply(this,[n,s,r]),dispatchEvent(a)}}),{updatePage:function(n,s){const r=window.location.pathname,a=J(n=n||r,t),o=[...(s&&J(r,t)||a).layouts,a];L.set(a),e({layouts:o,route:a})},click:function(t){const e=t.target.closest("a"),n=e&&e.getAttribute("href");t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button||t.defaultPrevented||n&&!e.target&&e.host===location.host&&(t.preventDefault(),history.pushState({},"",n))}}}function J(t,e){const n=e.find(e=>t.match(e.regex));if(!n)throw new Error(`Route could not be found. Make sure ${t}.svelte or ${t}/index.svelte exists. A restart may be required.`);if(n.paramKeys){const e=function(t){const e=[];return t.forEach(t=>{e[t.path.split("/").filter(Boolean).length-1]=t}),e}(n.layouts),s=t.split("/").filter(Boolean);(function(t){return t.split("/").filter(Boolean).map(t=>t.match(/\:(.+)/)).map(t=>t&&t[1])})(n.path).forEach((t,r)=>{t&&(n.params[t]=s[r],e[r]?e[r].param={[t]:s[r]}:n.param={[t]:s[r]})})}return n.leftover=t.replace(new RegExp(n.regex),""),n}function Q(t){let e;const n=new H({props:{layouts:t[0]}});return{c(){c(n.$$.fragment)},m(t,s){l(n,t,s),e=!0},p(t,[e]){const s={};1&e&&(s.layouts=t[0]),n.$set(s)},i(t){e||(g(n.$$.fragment,t),e=!0)},o(t){h(n.$$.fragment,t),e=!1},d(t){m(n,t)}}}function U(t,e,n){let s,r,{routes:a}=e;const{updatePage:o,click:c}=I(a,t=>n(0,({layouts:s,route:r}=t),s));return o(),w("routifyupdatepage",o),["pushstate","popstate","replacestate"].forEach(t=>addEventListener(t,()=>o())),addEventListener("click",c),t.$set=t=>{"routes"in t&&n(1,a=t.routes)},[s,a]}class V extends a{constructor(t){super(),o(this,t,U,Q,e,{routes:1})}}export{V as R,C as a,F as b,R as g,D as p,O as u};
//# sourceMappingURL=index-861cd15d.js.map
